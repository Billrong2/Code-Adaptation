{
  "code": "/**\n     * Translates the specified byte array into a Base64 string.\n     * <p>\n     * This method is intended for internal use (e.g. by {@link #makeAcceptKey(String)})\n     * and expects a non-null byte array.\n     *\n     * @param buf the byte array to encode (must not be {@code null})\n     * @return the translated Base64 string (never {@code null})\n     * @throws IllegalArgumentException if {@code buf} is {@code null}\n     */\n    private static String encodeBase64(byte[] buf) {\n        if (buf == null) {\n            throw new IllegalArgumentException(\"Input byte array must not be null\");\n        }\n\n        int size = buf.length;\n        char[] ar = new char[((size + 2) / 3) * 4];\n        int a = 0;\n        int i = 0;\n\n        while (i < size) {\n            byte b0 = buf[i++];\n            byte b1 = (i < size) ? buf[i++] : 0;\n            byte b2 = (i < size) ? buf[i++] : 0;\n\n            int mask = 0x3F;\n            ar[a++] = NanoWSD.ALPHABET[(b0 >> 2) & mask];\n            ar[a++] = NanoWSD.ALPHABET[((b0 << 4) | ((b1 & 0xFF) >> 4)) & mask];\n            ar[a++] = NanoWSD.ALPHABET[((b1 << 2) | ((b2 & 0xFF) >> 6)) & mask];\n            ar[a++] = NanoWSD.ALPHABET[b2 & mask];\n        }\n\n        switch (size % 3) {\n            case 1:\n                ar[--a] = '=';\n            case 2:\n                ar[--a] = '=';\n            default:\n                break;\n        }\n\n        return new String(ar);\n    }",
  "explanation": "code_hardening: Added a null-check for the input byte array and throw an IllegalArgumentException to clearly document and enforce the expected non-null usage.\nresolve_compilation_errors: Replaced the unqualified ALPHABET reference with NanoWSD.ALPHABET to match the target codebase and avoid undefined symbol errors; no additional imports required.\nexception_handling: None; no checked exceptions are introduced, and behavior matches the original algorithm.\nlogic_customization: None; the Base64 encoding algorithm and padding behavior remain identical to the SO snippet and compatible with makeAcceptKey.\nrefactoring: Renamed the method from encode to encodeBase64, changed visibility from public static to private static, and adjusted the Javadoc to reflect internal usage.\nmisc: Minor formatting cleanup and expanded Javadoc to align with project style; no new custom API calls were introduced."
}