{
  "code": "public static List<AdRecord> parseScanRecord(byte[] scanRecord) {\n    List<AdRecord> records = new ArrayList<>();\n\n    if (scanRecord == null || scanRecord.length == 0) {\n        return records;\n    }\n\n    int offset = 0;\n    while (offset < scanRecord.length) {\n        int length = scanRecord[offset++];\n        // Done once we run out of records\n        if (length == 0) {\n            break;\n        }\n\n        // Ensure length is positive and within remaining bounds\n        if (length < 0 || offset + length > scanRecord.length) {\n            break;\n        }\n\n        int type = scanRecord[offset];\n        // Done if our record isn't a valid type\n        if (type == 0) {\n            break;\n        }\n\n        byte[] data = Arrays.copyOfRange(scanRecord, offset + 1, offset + length);\n        records.add(new AdRecord(length, type, data));\n\n        // Advance\n        offset += length;\n    }\n\n    return records;\n}",
  "explanation": "code_hardening: Added a null and empty check for the scanRecord input and validated that length is positive and does not cause offset + length to exceed scanRecord.length before slicing.\nresolve_compilation_errors: Preserved usage of List, ArrayList, and Arrays consistent with the existing file imports and confirmed the AdRecord(int, int, byte[]) constructor is used as defined.\nexception_handling: Avoided introducing new exceptions; potential IndexOutOfBoundsException cases are prevented via explicit bounds checks and handled by terminating the loop safely.\nlogic_customization: Kept all original control flow and BLE record termination conditions (length == 0, type == 0) unchanged, only guarding them with additional validation.\nrefactoring: Applied the diamond operator for ArrayList instantiation, renamed the loop index variable from index to offset for clarity, and normalized spacing and brace style.\nmisc: Performed minor formatting cleanup and retained existing inline comments to clarify parsing steps; no new custom API calls were introduced."
}