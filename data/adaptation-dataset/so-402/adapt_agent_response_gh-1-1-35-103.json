{
  "code": "    /**\n     * Thanks go to Ola Bini for releasing this source on his blog. The source was\n     * obtained from <a href=\"http://olabini.com/blog/tag/evp_bytestokey/\">here</a>.\n     */\n    public static byte[][] EVP_BytesToKey(int key_len,\n                                         int iv_len,\n                                         MessageDigest md,\n                                         byte[] salt,\n                                         byte[] data,\n                                         int count) {\n        byte[][] both = new byte[2][];\n\n        byte[] key = new byte[key_len];\n        byte[] iv = new byte[iv_len];\n\n        int key_ix = 0;\n        int iv_ix = 0;\n\n        both[0] = key;\n        both[1] = iv;\n\n        byte[] md_buf = null;\n        int nkey = key_len;\n        int niv = iv_len;\n        int i = 0;\n\n        if (data == null) {\n            return both;\n        }\n\n        int addmd = 0;\n        for (;;) {\n            md.reset();\n\n            if (addmd++ > 0) {\n                md.update(md_buf);\n            }\n\n            md.update(data);\n\n            if (salt != null) {\n                md.update(salt, 0, 8);\n            }\n\n            md_buf = md.digest();\n\n            for (i = 1; i < count; i++) {\n                md.reset();\n                md.update(md_buf);\n                md_buf = md.digest();\n            }\n\n            i = 0;\n\n            if (nkey > 0) {\n                for (;;) {\n                    if (nkey == 0) {\n                        break;\n                    }\n                    if (i == md_buf.length) {\n                        break;\n                    }\n\n                    key[key_ix++] = md_buf[i++];\n                    nkey--;\n                }\n            }\n\n            if (niv > 0 && i != md_buf.length) {\n                for (;;) {\n                    if (niv == 0) {\n                        break;\n                    }\n                    if (i == md_buf.length) {\n                        break;\n                    }\n\n                    iv[iv_ix++] = md_buf[i++];\n                    niv--;\n                }\n            }\n\n            if (nkey == 0 && niv == 0) {\n                break;\n            }\n        }\n\n        for (i = 0; i < md_buf.length; i++) {\n            md_buf[i] = 0;\n        }\n\n        return both;\n    }",
  "explanation": "code_hardening: none\nresolve_compilation_errors: none\nexception_handling: none\nlogic_customization: none\nrefactoring: none\nmisc: Reformatted braces, spacing, and line breaks to match the target style; rewrapped the Javadoc text without changing its content; reformatted the parameter list and control-flow blocks while preserving identical logic, variables, and behavior."
}