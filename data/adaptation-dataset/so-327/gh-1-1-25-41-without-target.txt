package jp.satorufujiwara.http.utils;

import android.webkit.CookieManager;

import java.io.IOException;
import java.net.CookieHandler;
import java.net.URI;
import java.util.Arrays;
import java.util.HashMap;
import java.util.List;
import java.util.Map;


public class WebkitCookieManagerProxy extends CookieHandler {

    private CookieManager webkitCookieManager;

    public WebkitCookieManagerProxy() {
        webkitCookieManager = CookieManager.getInstance();
    }

    // TODO


    @Override
    public Map<String, List<String>> get(final URI uri,
            final Map<String, List<String>> requestHeaders) throws IOException {
        if (uri == null) {
            throw new IOException("uri is null.");
        }
        final String url = uri.toString();
        final Map<String, List<String>> res = new HashMap<>();
        final String cookie = webkitCookieManager.getCookie(url);
        if (cookie != null) {
            res.put("Cookie", Arrays.asList(cookie));
        }
        return res;
    }
}
