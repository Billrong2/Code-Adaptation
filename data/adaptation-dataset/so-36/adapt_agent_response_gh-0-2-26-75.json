{
  "code": "@Override\nprotected void onMeasure(int widthMeasureSpec, int heightMeasureSpec)\n{\n    // Call super() so that resolveUri() is called.\n    super.onMeasure(widthMeasureSpec, heightMeasureSpec);\n\n    // If there's no drawable we can just use the result from super.\n    if (getDrawable() == null)\n        return;\n\n    final int widthSpecMode = android.view.View.MeasureSpec.getMode(widthMeasureSpec);\n    final int heightSpecMode = android.view.View.MeasureSpec.getMode(heightMeasureSpec);\n\n    int w = getDrawable().getIntrinsicWidth();\n    int h = getDrawable().getIntrinsicHeight();\n    if (w <= 0)\n        w = 1;\n    if (h <= 0)\n        h = 1;\n\n    // Desired aspect ratio of the view's contents (not including padding)\n    float desiredAspect = (float) w / (float) h;\n\n    // We are allowed to change the view's width\n    boolean resizeWidth = widthSpecMode != android.view.View.MeasureSpec.EXACTLY;\n\n    // We are allowed to change the view's height\n    boolean resizeHeight = heightSpecMode != android.view.View.MeasureSpec.EXACTLY;\n\n    int pleft = getPaddingLeft();\n    int pright = getPaddingRight();\n    int ptop = getPaddingTop();\n    int pbottom = getPaddingBottom();\n\n    // Get the sizes that ImageView decided on.\n    int widthSize = getMeasuredWidth();\n    int heightSize = getMeasuredHeight();\n\n    if (resizeWidth && !resizeHeight)\n    {\n        // Resize the width to the height, maintaining aspect ratio.\n        int newWidth = (int) (desiredAspect * (heightSize - ptop - pbottom)) + pleft + pright;\n        setMeasuredDimension(newWidth, heightSize);\n    }\n    else if (resizeHeight && !resizeWidth)\n    {\n        int newHeight = (int) ((widthSize - pleft - pright) / desiredAspect) + ptop + pbottom;\n        setMeasuredDimension(widthSize, newHeight);\n    }\n}",
  "explanation": "code_hardening: none\nresolve_compilation_errors: Used fully qualified android.view.View.MeasureSpec references to avoid missing imports; otherwise identical.\nexception_handling: none\nlogic_customization: none\nrefactoring: none\nmisc: none"
}