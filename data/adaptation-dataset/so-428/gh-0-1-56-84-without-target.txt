
package com.entertailion.java.fling;

import java.awt.BasicStroke;
import java.awt.Color;
import java.awt.Component;
import java.awt.Font;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.RenderingHints;
import java.awt.Shape;
import java.awt.font.FontRenderContext;
import java.awt.font.TextLayout;
import java.awt.geom.AffineTransform;
import java.awt.geom.Point2D;
import java.awt.geom.Rectangle2D;
import java.awt.geom.RoundRectangle2D;
import java.io.IOException;
import java.util.Properties;

import javax.swing.BorderFactory;
import javax.swing.Icon;
import javax.swing.JComponent;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.SwingConstants;
import javax.swing.UIManager;


public class DragHereIcon implements Icon {
	private static final String LOG_TAG = "DragHereIcon";
	private int size = 80;
	private float a = 4f;
	private float b = 8f;
	private int r = 16;
	private int f = size / 4;
	private Font font = new Font("Monospace", Font.PLAIN, size / 2);
	private FontRenderContext frc = new FontRenderContext(null, true, true);
	private Shape s = new TextLayout("\u21E9", font, frc).getOutline(null);
	private Color linec = Color.GRAY;

	// TODO


	@Override
	public int getIconWidth() {
		return size;
	}

	@Override
	public int getIconHeight() {
		return size;
	}

	
	public static JComponent makeUI(final FlingFrame flingFrame) {
		JLabel label = new JLabel(new DragHereIcon());
		label.setText("<html>Drag <b>Media</b> Here");
		label.setVerticalTextPosition(SwingConstants.BOTTOM);
		label.setHorizontalTextPosition(SwingConstants.CENTER);
		label.setForeground(Color.GRAY);
		label.setFont(new Font("Monospace", Font.PLAIN, 24));
		JPanel p = new JPanel();
		p.add(label);
		p.setBorder(BorderFactory.createEmptyBorder(8, 8, 8, 8));
		new FileDrop(p, new FileDrop.Listener() {
			public void filesDropped(java.io.File[] files) {
				if (files != null && files.length > 0) {
					try {
						String file = files[0].getCanonicalPath();
						Log.d(LOG_TAG, file);
						Properties systemProperties = System.getProperties();
						systemProperties.setProperty(EmbeddedServer.CURRENT_FILE, file); 

						flingFrame.sendMediaUrl(file);
					} catch (IOException e) {
					}
				}
			} 
		}); 
		return p;
	}

}