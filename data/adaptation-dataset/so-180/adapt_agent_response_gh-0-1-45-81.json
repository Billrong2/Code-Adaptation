{
  "code": "public static String getCertificateSHA1Fingerprint(Context context) {\n    if (context == null) {\n        Log.e(TAG, \"Context is null\");\n        return null;\n    }\n\n    final String CERT_TYPE_X509 = \"X509\";\n    final String DIGEST_SHA1 = \"SHA1\";\n    final int SIGNATURE_FLAGS = PackageManager.GET_SIGNATURES;\n\n    try {\n        PackageManager pm = context.getPackageManager();\n        if (pm == null) {\n            Log.e(TAG, \"PackageManager is null\");\n            return null;\n        }\n\n        String packageName = context.getPackageName();\n        PackageInfo packageInfo = pm.getPackageInfo(packageName, SIGNATURE_FLAGS);\n        if (packageInfo == null || packageInfo.signatures == null || packageInfo.signatures.length == 0) {\n            Log.e(TAG, \"PackageInfo or signatures are unavailable\");\n            return null;\n        }\n\n        Signature signature = packageInfo.signatures[0];\n        byte[] certBytes = signature.toByteArray();\n\n        CertificateFactory certificateFactory = CertificateFactory.getInstance(CERT_TYPE_X509);\n        try (InputStream inputStream = new ByteArrayInputStream(certBytes)) {\n            X509Certificate certificate = (X509Certificate) certificateFactory.generateCertificate(inputStream);\n            if (certificate == null) {\n                Log.e(TAG, \"X509Certificate generation failed\");\n                return null;\n            }\n\n            MessageDigest messageDigest = MessageDigest.getInstance(DIGEST_SHA1);\n            byte[] publicKey = messageDigest.digest(certificate.getEncoded());\n            return byte2HexFormatted(publicKey);\n        }\n    } catch (PackageManager.NameNotFoundException e) {\n        Log.e(TAG, \"Package name not found\", e);\n    } catch (CertificateException e) {\n        Log.e(TAG, \"Certificate error while computing SHA1 fingerprint\", e);\n    } catch (NoSuchAlgorithmException e) {\n        Log.e(TAG, \"SHA1 algorithm not available\", e);\n    }\n\n    return null;\n}",
  "explanation": "code_hardening: Added null checks for Context, PackageManager, PackageInfo, signatures array, and generated X509Certificate; verified signatures length before access; used try-with-resources to ensure InputStream is always closed; introduced final local constants for certificate type, digest algorithm, and signature flags.\nresolve_compilation_errors: Replaced usage of instance field mContext with a Context method parameter; relied on existing imports in the file and existing static helper byte2HexFormatted; ensured all referenced Android and security classes are resolvable in this context.\nexception_handling: Replaced all printStackTrace calls with Log.e(TAG, message, exception); consolidated logic into a single try block with specific catch clauses matching the original failure points while preserving the null return behavior.\nlogic_customization: Adjusted calls to getPackageManager() and getPackageName() to use the provided Context; preserved the original SHA1 fingerprint computation flow and return semantics; continued using byte2HexFormatted without changing its output.\nrefactoring: Converted the method into a public static utility method; improved variable naming for clarity; reused the existing TAG constant for logging; simplified control flow while keeping behavior equivalent.\nmisc: Reformatted code to standard Android style and added concise log messages for failure scenarios; no new custom API calls introduced."
}