{
  "code": "@Override\npublic void paintBorder(Component c, Graphics g, int x, int y, int width, int height) {\n\n  final int INSET = 2;\n  final int POINTER_PAD = 4;\n\n  if (width <= 0 || height <= 0) {\n    return;\n  }\n\n  Graphics2D g2 = (Graphics2D) g;\n\n  // Adjusted bottom line to avoid overlap with stroke\n  int bottomLineY = height - thickness - pointerSize - 1;\n\n  // Apply inset to bubble geometry\n  int bubbleX = INSET + strokePad;\n  int bubbleY = INSET + strokePad;\n  int bubbleW = width - (INSET * 2) - thickness;\n  int bubbleH = bottomLineY - INSET;\n\n  // Guard against invalid geometry\n  if (bubbleW <= 0 || bubbleH <= 0) {\n    return;\n  }\n\n  RoundRectangle2D.Double bubble = new RoundRectangle2D.Double(\n    bubbleX,\n    bubbleY,\n    bubbleW,\n    bubbleH,\n    radii,\n    radii\n  );\n\n  // Build area starting with the rounded rectangle\n  Area area = new Area(bubble);\n\n  // Conditionally add the speech pointer\n  if (pointerSize > 0) {\n    java.awt.Polygon pointer = new java.awt.Polygon();\n\n    if (pointerLeft) {\n      // left point\n      pointer.addPoint(\n        bubbleX + radii + POINTER_PAD,\n        bottomLineY\n      );\n      // right point\n      pointer.addPoint(\n        bubbleX + radii + POINTER_PAD + pointerSize,\n        bottomLineY\n      );\n      // bottom point\n      pointer.addPoint(\n        bubbleX + radii + POINTER_PAD + (pointerSize / 2),\n        height - strokePad\n      );\n    } else {\n      // left point\n      pointer.addPoint(\n        width - (bubbleX + radii + POINTER_PAD),\n        bottomLineY\n      );\n      // right point\n      pointer.addPoint(\n        width - (bubbleX + radii + POINTER_PAD + pointerSize),\n        bottomLineY\n      );\n      // bottom point\n      pointer.addPoint(\n        width - (bubbleX + radii + POINTER_PAD + (pointerSize / 2)),\n        height - strokePad\n      );\n    }\n\n    area.add(new Area(pointer));\n  }\n\n  g2.setRenderingHints(hints);\n\n  // Paint the BG color of the parent everywhere outside the bubble clip\n  Component parent = c.getParent();\n  if (parent != null) {\n    Color bg = parent.getBackground();\n    Rectangle rect = new Rectangle(0, 0, width, height);\n    Area borderRegion = new Area(rect);\n    borderRegion.subtract(area);\n    g2.setClip(borderRegion);\n    g2.setColor(bg);\n    g2.fillRect(0, 0, width, height);\n    g2.setClip(null);\n  }\n\n  g2.setColor(color);\n  g2.setStroke(stroke);\n  g2.draw(area);\n}",
  "explanation": "code_hardening: Added guards for zero/negative width and height, validated inset-adjusted bubble dimensions, and ensured the pointer polygon is only constructed and added when pointerSize > 0.\nresolve_compilation_errors: none.\nexception_handling: none.\nlogic_customization: Inset the rounded rectangle by 2px on top/left and reduced width/height accordingly, reduced bottomLineY by 1px, replaced dynamic pointer padding with a fixed constant of 4, used the dedicated pointerLeft boolean to select pointer side, and built the Area from the rounded rectangle first before conditionally adding the pointer.\nrefactoring: Introduced named constants for inset and pointer padding, reordered geometry construction for clarity (bubble first, pointer second), and aligned variable naming with updated semantics.\nmisc: Updated inline comments to reflect optional pointer behavior, adjusted geometry, and preserved existing background clipping and final stroke drawing logic. New custom API calls: none."
}