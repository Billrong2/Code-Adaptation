{
  "code": "public static void addSelectOnFocusToText(final Text text) {\n\t// Provenance:\n\t// Adapted from a Stack Overflow solution addressing SWT Text select-on-focus behavior.\n\t// See also Eclipse Bug 46059: FocusIn is fired before MouseDown, which can cancel selection.\n\t// The logic below preserves the original event ordering and asynchronous behavior exactly.\n\tif (text == null || text.isDisposed())\n\t\treturn;\n\n\tListener listener = new Listener() {\n\n\t\tprivate boolean hasFocus = false;\n\t\tprivate boolean hadFocusOnMousedown = false;\n\n\t\tpublic void handleEvent(Event e) {\n\t\t\tswitch (e.type) {\n\t\t\tcase SWT.FocusIn: {\n\t\t\t\tText t = (Text) e.widget;\n\n\t\t\t\t// Covers the case where the user focuses the control by keyboard.\n\t\t\t\tt.selectAll();\n\n\t\t\t\t// Mouse focus is special because SWT.FocusIn is fired before SWT.MouseDown\n\t\t\t\t// and the mouse down cancels the selection. Track focus state asynchronously\n\t\t\t\t// so it is updated after the MouseDown event (see Eclipse bug 46059).\n\t\t\t\tt.getDisplay().asyncExec(new Runnable() {\n\t\t\t\t\tpublic void run() {\n\t\t\t\t\t\thasFocus = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase SWT.FocusOut: {\n\t\t\t\thasFocus = false;\n\t\t\t\t((Text) e.widget).clearSelection();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase SWT.MouseDown: {\n\t\t\t\t// Remember whether the control already had focus on mouse down.\n\t\t\t\thadFocusOnMousedown = hasFocus;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase SWT.MouseUp: {\n\t\t\t\tText t = (Text) e.widget;\n\t\t\t\tif (t.getSelectionCount() == 0 && !hadFocusOnMousedown) {\n\t\t\t\t\tt.selectAll();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\ttext.addListener(SWT.FocusIn, listener);\n\ttext.addListener(SWT.FocusOut, listener);\n\ttext.addListener(SWT.MouseDown, listener);\n\ttext.addListener(SWT.MouseUp, listener);\n}",
  "explanation": "code_hardening: Added a null and disposed check for the Text control before registering listeners to avoid invalid widget access; no other hardening was applied as per the plan.\nresolve_compilation_errors: Removed all @Override annotations from the anonymous Listener.handleEvent and Runnable.run methods to ensure compatibility with older Java/SWT compilers.\nexception_handling: none.\nlogic_customization: none; the select-on-focus behavior, event ordering, asyncExec usage, and selection conditions are preserved exactly as in the original Stack Overflow solution.\nrefactoring: Applied minor non-functional refactoring limited to formatting and comment wrapping for readability, without changing control flow or variable semantics.\nmisc: Added provenance and documentation comments referencing the original Stack Overflow solution and Eclipse Bug 46059; listener registration and event handling remain unchanged. No new custom API calls were introduced."
}