{
  "code": "public static void uncompressTarGZ(File tarFile, File dest) throws IOException {\n    final int BUFFER_SIZE = 8192;\n    if (tarFile == null || dest == null) {\n      throw new IllegalArgumentException(\"tarFile and dest must not be null\");\n    }\n    if (!dest.exists() && !dest.mkdirs()) {\n      throw new IOException(\"Could not create destination directory: \" + dest);\n    }\n\n    final String destCanonicalPath = dest.getCanonicalPath() + File.separator;\n\n    try (TarArchiveInputStream tarIn = new TarArchiveInputStream(\n        new GzipCompressorInputStream(\n            new BufferedInputStream(\n                new FileInputStream(tarFile))))) {\n\n      TarArchiveEntry tarEntry;\n      while ((tarEntry = tarIn.getNextTarEntry()) != null) {\n        File destPath = new File(dest, tarEntry.getName());\n\n        // Guard against path traversal\n        String destPathCanonical = destPath.getCanonicalPath();\n        if (!destPathCanonical.startsWith(destCanonicalPath)) {\n          throw new IOException(\"Blocked untrusted tar entry: \" + tarEntry.getName());\n        }\n\n        if (tarEntry.isDirectory()) {\n          if (!destPath.exists() && !destPath.mkdirs()) {\n            throw new IOException(\"Could not create directory: \" + destPath);\n          }\n          continue;\n        }\n\n        File parent = destPath.getParentFile();\n        if (parent != null && !parent.exists() && !parent.mkdirs()) {\n          throw new IOException(\"Could not create parent directories for: \" + destPath);\n        }\n\n        // Set executable flag for cassandra before creation/writing\n        if (\"cassandra\".equals(destPath.getName())) {\n          destPath.setExecutable(true);\n        }\n\n        try (BufferedOutputStream out = new BufferedOutputStream(new FileOutputStream(destPath))) {\n          byte[] buffer = new byte[BUFFER_SIZE];\n          int bytesRead;\n          while ((bytesRead = tarIn.read(buffer)) != -1) {\n            out.write(buffer, 0, bytesRead);\n          }\n        }\n      }\n    }\n  }",
  "explanation": "code_hardening: Added null checks for inputs, ensured destination directories exist, validated and created parent directories for files, guarded against path traversal by comparing canonical paths, and used try-with-resources to guarantee all streams are closed.\nresolve_compilation_errors: Preserved the existing method signature used by callers, relied on already-present Apache Commons Compress classes, and avoided introducing unused imports or helpers.\nexception_handling: Kept the throws IOException contract while adding contextual IOException messages; try-with-resources ensures cleanup even when exceptions occur.\nlogic_customization: Removed per-entry console logging and added a conditional check to set the executable bit when the destination file name equals \"cassandra\" before writing; extraction iteration and buffered streaming logic otherwise remains unchanged.\nrefactoring: Replaced the magic buffer size with a named constant, simplified variable names, and flattened control flow for clarity while staying within a single function.\nmisc: Added minimal inline comments to explain security and executable-setting behavior; no new custom API calls were introduced (none)."
}