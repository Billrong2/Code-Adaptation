{
  "code": "public static int getMeasuredHeight(final View view, float widthRatio) {\n        if (view == null) {\n            return 0;\n        }\n\n        final Context context = view.getContext();\n        if (context == null) {\n            return 0;\n        }\n\n        final WindowManager windowManager = (WindowManager) context.getSystemService(Context.WINDOW_SERVICE);\n        if (windowManager == null) {\n            return 0;\n        }\n\n        // Clamp widthRatio to a safe range\n        if (widthRatio <= 0f) {\n            widthRatio = 1f;\n        }\n        else if (widthRatio > 1f) {\n            widthRatio = 1f;\n        }\n\n        final Display display = windowManager.getDefaultDisplay();\n        final Point size = new Point();\n        display.getSize(size);\n\n        final int effectiveWidth = (int) (size.x * widthRatio);\n        Log.d(TAG, \"getMeasuredHeight(): effectiveWidth=\" + effectiveWidth);\n\n        final int widthMeasureSpec = View.MeasureSpec.makeMeasureSpec(effectiveWidth, View.MeasureSpec.AT_MOST);\n        final int heightMeasureSpec = View.MeasureSpec.makeMeasureSpec(0, View.MeasureSpec.UNSPECIFIED);\n        view.measure(widthMeasureSpec, heightMeasureSpec);\n\n        return view.getMeasuredHeight();\n    }",
  "explanation": "code_hardening: Added null checks for View, Context, and WindowManager, and validated/clamped widthRatio to a safe 0â€“1 range with a fallback to full width when invalid.\nresolve_compilation_errors: Introduced a new utility method operating on View (not TextView) with a signature that matches existing callers (animateExpand). Used existing project types and logging via android.util.Log with UtilsAnimation.TAG.\nexception_handling: none.\nlogic_customization: Replaced legacy width computation with a single Display.getSize(Point) path, applied widthRatio to compute the effective measurement width, preserved AT_MOST/UNSPECIFIED measure specs, and returned the measured height.\nrefactoring: Generalized naming to getMeasuredHeight for any View and renamed locals (effectiveWidth) for clarity.\nmisc: Added a debug Log.d statement outputting the computed effective width used for measurement; no new custom API calls beyond standard Android framework classes (android.view.Display#getSize(android.graphics.Point))."
}