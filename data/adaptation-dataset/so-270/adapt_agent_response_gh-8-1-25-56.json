{
  "code": "  @SuppressWarnings(\"unchecked\")\n  public void setEnvVar(String key, String value) {\n    if (key == null) {\n      return;\n    }\n    String safeValue = (value == null) ? \"\" : value;\n    try {\n      Class<?>[] classes = java.util.Collections.class.getDeclaredClasses();\n      Map<String, String> env = System.getenv();\n      if (env == null) {\n        return;\n      }\n      for (Class<?> cl : classes) {\n        if (\"java.util.Collections$UnmodifiableMap\".equals(cl.getName())) {\n          Field field = cl.getDeclaredField(\"m\");\n          field.setAccessible(true);\n          Object obj = field.get(env);\n          if (obj instanceof Map) {\n            Map<String, String> map = (Map<String, String>) obj;\n            map.put(key, safeValue);\n          }\n        }\n      }\n    } catch (IllegalAccessException e) {\n      // ignore: cannot modify environment\n    } catch (NoSuchFieldException e) {\n      // ignore: underlying map not accessible\n    } catch (SecurityException e) {\n      // ignore: access denied by security manager\n    }\n  }",
  "explanation": "code_hardening: Added a null check for the key, converted a null value to an empty string, guarded against a null environment map, and verified the reflected object is a Map before casting.\nresolve_compilation_errors: Updated the method to be an instance method with signature (String key, String value), used Class<?> instead of raw Class, relied on fully qualified references where needed, and added @SuppressWarnings(\"unchecked\") for the reflective cast.\nexception_handling: Removed checked exceptions from the signature and wrapped all reflection logic in try-catch blocks, explicitly catching and ignoring IllegalAccessException, NoSuchFieldException, and SecurityException.\nlogic_customization: Changed behavior to add or update only the specified environment variable instead of clearing or replacing the entire map, while preserving all existing entries and converting null values to empty strings.\nrefactoring: Renamed the method to a more descriptive setEnvVar and simplified local variable naming for readability while keeping logic localized to this function.\nmisc: none"
}