

package com.opera.core.systems.environment;

import java.lang.reflect.Field;
import java.util.Collections;
import java.util.Map;

public abstract class DefaultTestEnvironment implements TestEnvironment {

    // TODO


  
  @SuppressWarnings("unchecked")
  public void unset(String key) {
    try {
      Class<?>[] classes = Collections.class.getDeclaredClasses();
      Map<String, String> env = System.getenv();
      for (Class<?> cl : classes) {
        if ("java.util.Collections$UnmodifiableMap".equals(cl.getName())) {
          Field field = cl.getDeclaredField("m");
          field.setAccessible(true);
          Object obj = field.get(env);
          Map<String, String> map = (Map<String, String>) obj;
          map.remove(key);
        }
      }
    } catch (IllegalAccessException e) {
      
    } catch (NoSuchFieldException e) {
      
    }
  }

}