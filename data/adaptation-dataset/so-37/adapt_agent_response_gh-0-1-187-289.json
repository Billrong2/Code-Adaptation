{
  "code": "public static final String convertGlobToRegex(String pattern) {\n    // Adapted from a StackOverflow answer on glob-to-regex conversion.\n    // Original source: https://stackoverflow.com/questions/1247772/is-there-an-equivalent-of-java-util-regex-for-glob-type-patterns\n    // Logic preserved; minor performance and robustness tweaks applied.\n\n    if (pattern == null) {\n      throw new IllegalArgumentException(\"pattern must not be null\");\n    }\n\n    final StringBuilder sb = new StringBuilder(pattern.length() * 2);\n    int inGroup = 0;\n    int inClass = 0;\n    int firstIndexInClass = -1;\n    final char[] arr = pattern.toCharArray();\n\n    for (int i = 0; i < arr.length; i++) {\n      final char ch = arr[i];\n      switch (ch) {\n        case '\\\\':\n          if (++i >= arr.length) {\n            sb.append('\\\\');\n          } else {\n            final char next = arr[i];\n            switch (next) {\n              case ',':\n                // escape not needed\n                break;\n              case 'Q':\n              case 'E':\n                // extra escape needed\n                sb.append('\\\\');\n              default:\n                sb.append('\\\\');\n            }\n            sb.append(next);\n          }\n          break;\n        case '*':\n          if (inClass == 0)\n            sb.append(\".*\");\n          else\n            sb.append('*');\n          break;\n        case '?':\n          if (inClass == 0)\n            sb.append('.');\n          else\n            sb.append('?');\n          break;\n        case '[':\n          inClass++;\n          firstIndexInClass = i + 1;\n          sb.append('[');\n          break;\n        case ']':\n          inClass--;\n          sb.append(']');\n          break;\n        case '.':\n        case '(':\n        case ')':\n        case '+':\n        case '|':\n        case '^':\n        case '$':\n        case '@':\n        case '%':\n          if (inClass == 0 || (firstIndexInClass == i && ch == '^'))\n            sb.append('\\\\');\n          sb.append(ch);\n          break;\n        case '!':\n          if (firstIndexInClass == i)\n            sb.append('^');\n          else\n            sb.append('!');\n          break;\n        case '{':\n          inGroup++;\n          sb.append('(');\n          break;\n        case '}':\n          inGroup--;\n          sb.append(')');\n          break;\n        case ',':\n          if (inGroup > 0)\n            sb.append('|');\n          else\n            sb.append(',');\n          break;\n        default:\n          sb.append(ch);\n      }\n    }\n    return sb.toString();\n  }",
  "explanation": "code_hardening: Added a null check for the pattern parameter and defined behavior by throwing IllegalArgumentException; marked StringBuilder and char array locals as final where applicable.\nresolve_compilation_errors: none.\nexception_handling: No try/catch introduced; method throws IllegalArgumentException for invalid input.\nlogic_customization: none; glob-to-regex conversion logic is unchanged.\nrefactoring: Initialized StringBuilder with pattern.length() * 2 to reduce reallocations; minor formatting and final modifiers for readability.\nmisc: Added attribution comments referencing the original StackOverflow source and noted that logic is preserved."
}