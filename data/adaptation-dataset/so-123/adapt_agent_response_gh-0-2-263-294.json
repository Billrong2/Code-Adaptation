{
  "code": "public static String truncateWhenUTF8(final String s, final int maxBytes) {\n    // Attribution: adapted from a Stack Overflow answer (placeholder for SO link/ID)\n    int b = 0;\n\n    for (int i = 0; i < s.length(); i++) {\n        final char c = s.charAt(i);\n\n        // Ranges from http://en.wikipedia.org/wiki/UTF-8\n        int skip = 0;\n        final int more;\n\n        if (c <= 0x007f) {\n            more = 1;\n        } else if (c <= 0x07FF) {\n            more = 2;\n        } else if (c <= 0xD7FF) {\n            more = 3;\n        } else if (c <= 0xDFFF) {\n            // Surrogate area, consume next char as well\n            more = 4;\n            skip = 1;\n        } else {\n            more = 3;\n        }\n\n        if (b + more > maxBytes) {\n            return s.substring(0, i);\n        }\n\n        b += more;\n        i += skip;\n    }\n\n    return s;\n}",
  "explanation": "code_hardening: Added final modifiers to both method parameters and to the local char variable as planned; no null check was added to avoid any behavioral change.\nresolve_compilation_errors: none.\nexception_handling: none.\nlogic_customization: none; the UTF-8 byte calculation logic, loop structure, and return conditions are preserved exactly.\nrefactoring: Applied minor formatting and brace/whitespace normalization for readability without altering control flow or semantics.\nmisc: Inserted an attribution comment indicating Stack Overflow origin (placeholder) and aligned comment formatting to match surrounding style."
}