{
  "code": "public static String encrypt(final String secretKey, final String ivString, final String plainText) {\n        if (secretKey == null || secretKey.isEmpty() || ivString == null || ivString.isEmpty() || plainText == null) {\n            return null;\n        }\n        try {\n            final byte[] keyBytes = secretKey.getBytes(Constants.BASE_ENCODING);\n            final byte[] ivBytes = ivString.getBytes(Constants.BASE_ENCODING);\n            if (!(keyBytes.length == 16 || keyBytes.length == 24 || keyBytes.length == 32)) {\n                return null;\n            }\n            if (ivBytes.length != 16) {\n                return null;\n            }\n            final IvParameterSpec iv = new IvParameterSpec(ivBytes);\n            final SecretKeySpec skeySpec = new SecretKeySpec(keyBytes, \"AES\");\n            final Cipher cipher = Cipher.getInstance(\"AES/CBC/PKCS5PADDING\");\n            cipher.init(Cipher.ENCRYPT_MODE, skeySpec, iv);\n            final byte[] encrypted = cipher.doFinal(plainText.getBytes(Constants.BASE_ENCODING));\n            return Base64.encodeBase64String(encrypted);\n        } catch (java.io.UnsupportedEncodingException | java.security.GeneralSecurityException ex) {\n            return null;\n        }\n    }",
  "explanation": "code_hardening: Added null and empty checks for all inputs, validated AES key lengths (16/24/32 bytes) and IV length (16 bytes), and marked parameters and locals as final where applicable.\nresolve_compilation_errors: Replaced hardcoded charset strings with Constants.BASE_ENCODING and ensured Base64 usage aligns with org.apache.commons.codec.binary.Base64.encodeBase64String; no additional imports were required.\nexception_handling: Narrowed the catch block to UnsupportedEncodingException and GeneralSecurityException, removed stack trace printing, and consistently return null on failure to match existing decrypt behavior.\nlogic_customization: Updated all byte conversions to use the shared Constants.BASE_ENCODING and removed console logging while preserving AES/CBC/PKCS5PADDING encryption logic and return value.\nrefactoring: Renamed parameters to secretKey, ivString, and plainText for clarity and replaced implicit charset usage with explicit shared constants.\nmisc: Reformatted code to align with project style and added minimal defensive checks without altering external behavior; no new custom API calls were introduced."
}