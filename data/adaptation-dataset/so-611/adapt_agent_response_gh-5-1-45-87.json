{
  "code": "@Override\nprotected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {\n    // Parent width must be constrained\n    final int parentWidthMode = View.MeasureSpec.getMode(widthMeasureSpec);\n    final int parentWidthSize = View.MeasureSpec.getSize(widthMeasureSpec);\n\n    final int width = parentWidthSize - getPaddingLeft() - getPaddingRight();\n    int height = View.MeasureSpec.getSize(heightMeasureSpec) - getPaddingTop() - getPaddingBottom();\n\n    final int count = getChildCount();\n    int line_height = 0;\n\n    int xpos = getPaddingLeft();\n    int ypos = getPaddingTop();\n\n    for (int i = 0; i < count; i++) {\n        final View child = getChildAt(i);\n        if (child.getVisibility() != GONE) {\n            final LayoutParams lp = (LayoutParams) child.getLayoutParams();\n\n            // Always measure child height with UNSPECIFIED; width remains AT_MOST\n            child.measure(\n                    View.MeasureSpec.makeMeasureSpec(width, View.MeasureSpec.AT_MOST),\n                    View.MeasureSpec.makeMeasureSpec(0, View.MeasureSpec.UNSPECIFIED)\n            );\n\n            final int childw = child.getMeasuredWidth();\n            line_height = Math.max(line_height, child.getMeasuredHeight() + lp.vertical_spacing);\n\n            if (xpos + childw > width) {\n                xpos = getPaddingLeft();\n                ypos += line_height;\n            }\n\n            xpos += childw + lp.horizontal_spacing;\n        }\n    }\n\n    this.line_height = line_height;\n\n    final int parentHeightMode = View.MeasureSpec.getMode(heightMeasureSpec);\n    if (parentHeightMode == View.MeasureSpec.UNSPECIFIED) {\n        height = ypos + line_height;\n    } else if (parentHeightMode == View.MeasureSpec.AT_MOST) {\n        if (ypos + line_height < height) {\n            height = ypos + line_height;\n        }\n    }\n\n    setMeasuredDimension(width, height);\n}",
  "explanation": "code_hardening: none\nresolve_compilation_errors: Used fully qualified View.MeasureSpec references to avoid reliance on imports; otherwise no compilation fixes were required.\nexception_handling: none\nlogic_customization: Modified child measurement so that each child is always measured with height MeasureSpec.UNSPECIFIED, independent of the parent height mode. Removed the conditional logic that previously varied child height based on the parent and inlined the height MeasureSpec creation directly in the child.measure(...) call while keeping width as AT_MOST.\nrefactoring: Removed the separate childHeightMeasureSpec variable and minimally restructured the loop to inline the measurement call without altering layout flow, line height tracking, or final dimension calculations.\nmisc: none"
}