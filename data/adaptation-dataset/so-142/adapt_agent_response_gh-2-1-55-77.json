{
  "code": "@Override\nprotected void applyTransformation(float interpolatedTime, Transformation t) {\n    super.applyTransformation(interpolatedTime, t);\n\n    if (mAnimatedView == null) {\n        return;\n    }\n\n    android.view.ViewGroup.LayoutParams params = mAnimatedView.getLayoutParams();\n    if (params == null) {\n        return;\n    }\n\n    // Guard against invalid end height\n    int safeEndHeight = mEndHeight < 0 ? 0 : mEndHeight;\n\n    if (interpolatedTime < 1.0f) {\n        if (mType == 0) {\n            // Expanding\n            params.height = (int) (safeEndHeight * interpolatedTime);\n        } else {\n            // Collapsing\n            params.height = safeEndHeight - (int) (safeEndHeight * interpolatedTime);\n        }\n        mAnimatedView.requestLayout();\n    } else {\n        if (mType == 0) {\n            // Expansion finished\n            params.height = safeEndHeight;\n            mAnimatedView.requestLayout();\n        } else {\n            // Collapse finished\n            params.height = 0;\n            mAnimatedView.setVisibility(View.GONE);\n            mAnimatedView.requestLayout();\n            // Preset height for future use instead of WRAP_CONTENT\n            params.height = safeEndHeight;\n        }\n    }\n}",
  "explanation": "code_hardening: Added null checks for mAnimatedView and its LayoutParams and guarded against negative mEndHeight values by normalizing to a safe non-negative height.\nresolve_compilation_errors: Used fully qualified android.view.ViewGroup.LayoutParams inside the function to avoid missing import issues; relied on existing class fields mAnimatedView, mEndHeight, and mType.\nexception_handling: none\nlogic_customization: Changed the post-collapse logic to set the view height back to mEndHeight after setting visibility to GONE, instead of using LayoutParams.WRAP_CONTENT, while preserving all existing animation branches and requestLayout() calls.\nrefactoring: none\nmisc: none"
}