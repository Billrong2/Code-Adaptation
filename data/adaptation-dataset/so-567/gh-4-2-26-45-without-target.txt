package com.medisanaspace.library;

import java.util.Arrays;
import java.util.Comparator;
import java.util.LinkedHashMap;
import java.util.Map;
import java.util.logging.Level;
import java.util.logging.Logger;

import com.medisanaspace.web.library.SignatureHelper;


public final class MapUtil {

	private MapUtil() {
	}

	// TODO


	
	public static String createBaseParameterString(
			final Map<String, String> signatureMap, final String parameterString) {

		if (StringUtil.isNotNullOrEmpty(parameterString)) {
			String[] parameterList = parameterString.split("&");

			for (String parameter : parameterList) {
				String[] pair = parameter.split("=");
				if (pair.length != 2) {
					Logger.getLogger(SignatureHelper.class.getName()).log(
							Level.WARNING,
							"Invalid parameter string (entry is missing \"=\":"
									+ parameterString + ").");
					return "Invalid parameter string (entry is missing \"=\")";
				}
				String key = pair[0];
				String value = pair[1];
				signatureMap.put(key, value);
			}
		}

		Map<String, String> sortedSignatureMap = MapUtil
				.sortByKey(signatureMap);

		StringBuilder stringBuilder = new StringBuilder();
		boolean first = true;

		for (Map.Entry<String, String> entry : sortedSignatureMap.entrySet()) {
			if (!first) {
				stringBuilder.append("&");
			}
			stringBuilder.append(entry.getKey() + "=" + entry.getValue());
			first = false;
		}

		return stringBuilder.toString();
	}

}
