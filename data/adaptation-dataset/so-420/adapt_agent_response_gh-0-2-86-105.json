{
  "code": "/**\n * Scales a {@link java.awt.image.BufferedImage} by the given ratio using an affine transform.\n * <p>\n * Source: Stack Overflow (image scaling using {@link java.awt.geom.AffineTransform}).\n * </p>\n *\n * @param source the source image to scale; must not be {@code null}\n * @param ratio  scale ratio (e.g. {@code 0.5} for 50%); must be {@code > 0}\n * @return a new {@link java.awt.image.BufferedImage} containing the scaled image\n * @throws IllegalArgumentException if {@code source} is {@code null} or {@code ratio <= 0}\n */\nprivate static BufferedImage scale(final BufferedImage source, final double ratio) {\n\tif (source == null) {\n\t\tthrow new IllegalArgumentException(\"source image must not be null\");\n\t}\n\tif (ratio <= 0) {\n\t\tthrow new IllegalArgumentException(\"ratio must be > 0\");\n\t}\n\n\tfinal int w = (int) (source.getWidth() * ratio);\n\tfinal int h = (int) (source.getHeight() * ratio);\n\n\tfinal BufferedImage bi = getCompatibleImage(w, h);\n\tfinal Graphics2D g2d = bi.createGraphics();\n\ttry {\n\t\tfinal double xScale = (double) w / source.getWidth();\n\t\tfinal double yScale = (double) h / source.getHeight();\n\t\tfinal AffineTransform at = AffineTransform.getScaleInstance(xScale, yScale);\n\t\tg2d.drawRenderedImage(source, at);\n\t}\n\tfinally {\n\t\tg2d.dispose();\n\t}\n\treturn bi;\n}",
  "explanation": "code_hardening: Added null check for the source image and validation that ratio is greater than zero; marked local variables as final; ensured Graphics2D is disposed via a try/finally block.\nresolve_compilation_errors: Converted the method to a static utility method and relied on the existing static getCompatibleImage(int, int) so it is callable from a static context; no other compilation issues.\nexception_handling: Introduced IllegalArgumentException for invalid inputs and documented it in JavaDoc; no checked exceptions added.\nlogic_customization: none.\nrefactoring: Changed the method signature from instance to static, kept the original scaling logic intact, and added comprehensive JavaDoc with summary, parameters, return description, and source note.\nmisc: Reformatted code to match standard conventions and added only JavaDoc comments as requested; no new custom API calls beyond existing project methods (getCompatibleImage)."
}