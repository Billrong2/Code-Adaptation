{
  "code": "public static Map<String, Object> toMap(final JSONObject json) throws JSONException {\n        final Map<String, Object> map = new HashMap<>();\n        if (json == null || json == JSONObject.NULL) {\n            return map;\n        }\n\n        final Iterator<String> keysItr = json.keys();\n        while (keysItr.hasNext()) {\n            final String key = keysItr.next();\n            Object value = json.get(key);\n\n            if (value == JSONObject.NULL) {\n                value = null;\n            } else if (value instanceof JSONArray) {\n                value = toList((JSONArray) value);\n            } else if (value instanceof JSONObject) {\n                value = toMap((JSONObject) value);\n            }\n            map.put(key, value);\n        }\n        return map;\n    }",
  "explanation": "code_hardening: Added null checks for the input JSONObject and explicitly handled JSONObject.NULL values by converting them to Java null to avoid propagating sentinel objects; used final for parameters and locals where appropriate.\nresolve_compilation_errors: Replaced the legacy JsonObject/JsonArray usage with org.json.JSONObject and org.json.JSONArray, and switched key iteration to JSONObject.keys() returning Iterator<String>; ensured recursive calls align with existing toList(JSONArray) and toMap(JSONObject) signatures.\nexception_handling: Updated the method signature to throw JSONException consistently with the surrounding codebase and relied on JSONObject.get throwing JSONException for invalid access rather than introducing local try/catch blocks.\nlogic_customization: Updated instanceof checks and casts to JSONObject/JSONArray and preserved the recursive conversion logic so nested JSON structures are converted into Map and List representations correctly.\nrefactoring: Simplified generics using the diamond operator, clarified variable naming, and streamlined control flow while keeping the method name and signature consistent with JsonUtils.\nmisc: Formatted code to match standard Java style and aligned behavior with existing jsonToMap and toList utilities; no new custom API calls were introduced."
}