{
  "code": "    /**\n     * Finds the first occurrence of a byte-pattern within the given data using\n     * the Knuth–Morris–Pratt (KMP) string-search algorithm adapted for byte arrays.\n     * <p>\n     * This method scans the {@code data} array for the first index at which the\n     * complete {@code pattern} occurs and returns that zero-based index, or\n     * {@code -1} if the pattern cannot be found.\n     * </p>\n     * <p>\n     * Implementation is based on a KMP failure-function approach to ensure\n     * linear-time complexity relative to the input sizes.\n     * </p>\n     * <p>\n     * Attribution: adapted from an algorithm originally published on Stack Overflow\n     * (exact question/answer reference to be filled in).\n     * </p>\n     *\n     * @param data the byte array to search within\n     * @param pattern the byte pattern to search for\n     * @return the index of the first occurrence of {@code pattern} in {@code data},\n     *         or {@code -1} if not found\n     */\n    private int indexOf(final byte[] data, final byte[] pattern) {\n        int[] failure = computeFailure(pattern);\n\n        int j = 0;\n        if (data.length == 0) return -1;\n\n        for (int i = 0; i < data.length; i++) {\n            while (j > 0 && pattern[j] != data[i]) {\n                j = failure[j - 1];\n            }\n            if (pattern[j] == data[i]) { j++; }\n            if (j == pattern.length) {\n                return i - pattern.length + 1;\n            }\n        }\n        return -1;\n    }",
  "explanation": "code_hardening: Method parameters were marked as final to prevent reassignment; no additional guards were added to avoid altering behavior.\nresolve_compilation_errors: none.\nexception_handling: none.\nlogic_customization: none; the KMP-based search logic remains unchanged.\nrefactoring: The method visibility was changed from public to private to internalize API usage while preserving the name, signature, and behavior relied upon by internal callers.\nmisc: Expanded Javadoc to clearly document the KMP byte-pattern search algorithm and added a Stack Overflow attribution placeholder, along with minor documentation and formatting consistency updates."
}