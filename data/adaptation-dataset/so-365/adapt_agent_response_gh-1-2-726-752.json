{
  "code": "private void drawTextOnCanvasWithMagnifier(final android.graphics.Canvas canvas, final String text, final float x, final float y, final android.graphics.Paint paint) {\n\tif (canvas == null || paint == null) {\n\t\treturn;\n\t}\n\n\tfinal String safeText = (text != null) ? text : \"\";\n\n\t// Draw normally on pre-Jelly Bean devices\n\tif (android.os.Build.VERSION.SDK_INT <= 15) {\n\t\tcanvas.drawText(safeText, x, y, paint);\n\t\treturn;\n\t}\n\n\t// Workaround for Jelly Bean+ where small text/strokes may render too thin or disappear\n\tfinal float MAGNIFIER_SCALE = 1000f;\n\tfinal float originalTextSize = paint.getTextSize();\n\tfinal float originalStrokeWidth = paint.getStrokeWidth();\n\n\tcanvas.save();\n\ttry {\n\t\tcanvas.scale(1f / MAGNIFIER_SCALE, 1f / MAGNIFIER_SCALE);\n\t\tpaint.setTextSize(originalTextSize * MAGNIFIER_SCALE);\n\t\tpaint.setStrokeWidth(originalStrokeWidth * MAGNIFIER_SCALE);\n\t\tcanvas.drawText(safeText, x * MAGNIFIER_SCALE, y * MAGNIFIER_SCALE, paint);\n\t} finally {\n\t\tcanvas.restore();\n\t\tpaint.setTextSize(originalTextSize);\n\t\tpaint.setStrokeWidth(originalStrokeWidth);\n\t}\n}",
  "explanation": "code_hardening: Added null checks for Canvas and Paint, ensured text is never null, preserved both original text size and stroke width, and guaranteed canvas.save()/restore() pairing via try/finally.\nresolve_compilation_errors: none.\nexception_handling: none.\nlogic_customization: Enhanced the SDK > 15 workaround path to scale Paint stroke width proportionally with the magnifier alongside text size, while keeping the original SDK check and magnifier-based scaling logic intact.\nrefactoring: Replaced the magic value 1000f with a named constant (MAGNIFIER_SCALE) and grouped logic into clear phases: save original state, apply magnifier and draw, then restore state.\nmisc: Added brief comments documenting why magnifier-based scaling (including stroke width) is required for consistent text rendering on Jelly Bean and above; no new custom API calls were introduced."
}