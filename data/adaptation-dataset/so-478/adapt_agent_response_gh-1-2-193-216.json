{
  "code": "@Override\npublic void setEnabledProtocols(String[] protocols) {\n    final String SSLV2 = \"SSLv2\";\n    final String SSLV3 = \"SSLv3\";\n\n    // Only apply workaround when the input is exactly [\"SSLv3\"]\n    if (protocols != null && protocols.length == 1 && SSLV3.equals(protocols[0])) {\n        // Choose base protocol list depending on compatibility flag\n        String[] baseProtocols = compatible ? delegate.getEnabledProtocols()\n                                            : delegate.getSupportedProtocols();\n\n        if (baseProtocols != null && baseProtocols.length > 0) {\n            final java.util.List<String> adjusted = new java.util.ArrayList<String>(\n                    java.util.Arrays.asList(baseProtocols));\n\n            if (adjusted.size() > 1) {\n                // Remove legacy SSL protocols when multiple choices are available\n                adjusted.remove(SSLV2);\n                adjusted.remove(SSLV3);\n            }\n\n            if (adjusted.size() <= 1) {\n                android.util.Log.w(TAG,\n                        \"SSL stuck with single protocol available: \" + String.valueOf(adjusted));\n            }\n\n            protocols = adjusted.toArray(new String[adjusted.size()]);\n        }\n    }\n\n    super.setEnabledProtocols(protocols);\n}",
  "explanation": "code_hardening: Added null and length checks for the incoming protocols array and the base protocol list from the delegate; used a defensive copy via a new ArrayList; avoided assumptions about availability; used final constants and locals where appropriate.\nresolve_compilation_errors: Used the existing android.util.Log warning logger with the already-defined TAG constant; referenced the existing compatible flag and delegate field available in this class hierarchy; used fully qualified java.util classes inside the function.\nexception_handling: none.\nlogic_customization: Preserved the exact trigger condition (only when protocols equals [\"SSLv3\"]); conditionally selected delegate.getEnabledProtocols() vs delegate.getSupportedProtocols() based on the compatible flag; removed both \"SSLv2\" and \"SSLv3\" when multiple protocols are present; rebuilt the final protocol array and passed it to super.setEnabledProtocols as before.\nrefactoring: Replaced System.out.println with structured warning-level logging; replaced magic strings with local constants; simplified control flow while keeping all logic within this single function.\nmisc: Removed any success logging entirely and logged only a warning when left with a single protocol after filtering; no new custom APIs beyond android.util.Log.w were introduced."
}