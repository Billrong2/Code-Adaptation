

package uk.ac.ucl.excites.sapelli.shared.util;

import java.util.Comparator;


public class VersionComparator implements Comparator<String>
{

	static public boolean isAtLeast(String testVersion, String minimumVersion)
	{
		return new VersionComparator().compare(testVersion, minimumVersion) >= 0;
	}
	
	public boolean equals(Object o1, Object o2)
	{
		if(o1 instanceof String && o2 instanceof String)
			return compare((String) o1, (String) o2) == 0;
		else
			return o1 == o2;
	}

	// TODO


	public class VersionTokenizer
	{
		private final String versionString;
		private final int length;

		private int position;
		private int number;
		private String suffix;

		public VersionTokenizer(String versionString)
		{
			if(versionString == null)
				throw new IllegalArgumentException("versionString is null");
			this.versionString = versionString;
			this.length = versionString.length();
		}
		
		public int getNumber()
		{
			return number;
		}

		public String getSuffix()
		{
			return suffix;
		}

		public boolean moveNext()
		{
			number = 0;
			suffix = "";

			
			if(position >= length)
				return false;

			while(position < length)
			{
				char c = versionString.charAt(position);
				if(c < '0' || c > '9')
					break;
				number = number * 10 + (c - '0');
				position++;
			}

			int suffixStart = position;
			while(position < length)
			{
				char c = versionString.charAt(position);
				if(c == '.')
					break;
				position++;
			}

			suffix = versionString.substring(suffixStart, position);
			if(position < length)
				position++;

			return true;
		}
	}

}