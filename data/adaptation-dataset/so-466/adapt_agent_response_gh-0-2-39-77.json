{
  "code": "    @Override\n    public void configure(final WebAppContext context) throws Exception\n    {\n        boolean metadataComplete = context.getMetaData().isMetaDataComplete();\n\n        context.addDecorator(\n            new AnnotationDecorator(\n                context\n            )\n        );\n\n        // Even if metadata is complete, we still need to scan for\n        // ServletContainerInitializers - if there are any\n        AnnotationParser parser = null;\n\n        if (!metadataComplete)\n        {\n            // If metadata isn't complete, if this is a servlet 3 webapp\n            // or isConfigurationDiscovered is true, we need to search for annotations\n            if ((context.getServletContext().getEffectiveMajorVersion() >= 3)\n                || (context.isConfigurationDiscovered()))\n            {\n                _discoverableAnnotationHandlers.add(\n                    new WebServletAnnotationHandler(\n                        context\n                    )\n                );\n                _discoverableAnnotationHandlers.add(\n                    new WebFilterAnnotationHandler(\n                        context\n                    )\n                );\n                _discoverableAnnotationHandlers.add(\n                    new WebListenerAnnotationHandler(\n                        context\n                    )\n                );\n            }\n        }\n\n        // Regardless of metadata, if there are any ServletContainerInitializers\n        // with @HandlesTypes, then we need to scan all the classes so we can\n        // call their onStartup() methods correctly\n        createServletContainerInitializerAnnotationHandlers(\n            context,\n            getNonExcludedInitializers(\n                context\n            )\n        );\n\n        if ((!_discoverableAnnotationHandlers.isEmpty())\n            || (_classInheritanceHandler != null)\n            || (!_containerInitializerAnnotationHandlers.isEmpty()))\n        {\n            parser = createAnnotationParser();\n\n            parse(\n                context,\n                parser\n            );\n\n            for (DiscoverableAnnotationHandler h : _discoverableAnnotationHandlers)\n            {\n                context.getMetaData().addDiscoveredAnnotations(\n                    ((AbstractDiscoverableAnnotationHandler) h).getAnnotationList()\n                );\n            }\n        }\n    }\n",
  "explanation": "code_hardening: none\nresolve_compilation_errors: none\nexception_handling: none\nlogic_customization: none\nrefactoring: Reformatted indentation and brace placement, wrapped the enhanced for-loop body in braces, added redundant parentheses to conditional expressions, and split long conditions and method calls across multiple lines without changing semantics.\nmisc: Adjusted whitespace and line breaks for readability and added line wrapping to comments and chained calls while preserving identical behavior."
}