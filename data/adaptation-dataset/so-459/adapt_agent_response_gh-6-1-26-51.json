{
  "code": "/**\n     * Generate a cryptographic hash for the given text using the specified algorithm and optional salt.\n     * <p>\n     * If {@code salt} is non-blank, it is appended to {@code text} prior to hashing. If the requested\n     * algorithm is not available, this method returns {@code null}.\n     * </p>\n     *\n     * @param text the input text to hash; if {@code null}, this method returns {@code null}\n     * @param salt optional salt to append to the text before hashing\n     * @param hashType the message digest algorithm (e.g., \"MD5\", \"SHA1\", \"SHA-256\")\n     * @return the hex-encoded hash, or {@code null} if the algorithm is unavailable or input is invalid\n     */\n    public static String getHash(final String text, final String salt, final String hashType) {\n        if (text == null || hashType == null) {\n            return null;\n        }\n\n        final StringBuilder inputBuilder = new StringBuilder(text);\n        if (org.apache.commons.lang.StringUtils.isNotBlank(salt)) {\n            inputBuilder.append(salt);\n        }\n\n        try {\n            final java.security.MessageDigest messageDigest = java.security.MessageDigest.getInstance(hashType);\n            final byte[] digestBytes = messageDigest.digest(\n                    inputBuilder.toString().getBytes(java.nio.charset.StandardCharsets.UTF_8));\n\n            final StringBuffer hexString = new StringBuffer();\n            for (int i = 0; i < digestBytes.length; ++i) {\n                hexString.append(Integer.toHexString((digestBytes[i] & 0xFF) | 0x100).substring(1, 3));\n            }\n            return hexString.toString();\n        } catch (java.security.NoSuchAlgorithmException e) {\n            // TODO: add proper error handling or logging if required\n        }\n        return null;\n    }",
  "explanation": "code_hardening: Added null checks for text and hashType, used explicit UTF-8 encoding via java.nio.charset.StandardCharsets.UTF_8, kept the method static and stateless, and marked local variables as final where applicable.\nresolve_compilation_errors: Introduced the getHash(String, String, String) static method expected by existing callers and used fully qualified class names (java.security.MessageDigest, java.nio.charset.StandardCharsets, org.apache.commons.lang.StringUtils) to avoid import issues.\nexception_handling: Retained catching NoSuchAlgorithmException and preserved the existing behavior of returning null, adding an explicit TODO placeholder comment for future logging or handling.\nlogic_customization: Replaced the hard-coded MD5 algorithm with the configurable hashType parameter and implemented optional salting by appending salt only when StringUtils.isNotBlank(salt) is true; reused the original byte-to-hex conversion logic unchanged.\nrefactoring: Renamed and consolidated hashing logic into a single static getHash method to be used by md5, sha1, sha256, and their salted variants; clarified variable names for readability.\nmisc: Added basic Javadoc and minimal inline comments to document configurable algorithm and salting behavior; no additional custom APIs beyond org.apache.commons.lang.StringUtils.isNotBlank were introduced."
}