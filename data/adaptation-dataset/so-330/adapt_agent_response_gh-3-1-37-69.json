{
  "code": "public java.security.PublicKey decodePublicKey(String keyLine) throws java.security.GeneralSecurityException {\n    if (keyLine == null || keyLine.trim().isEmpty()) {\n        throw new IllegalArgumentException(\"keyLine is null or empty\");\n    }\n\n    final String BASE64_PREFIX = \"AAAA\";\n\n    // initialize parsing state\n    this.bytes = null;\n    this.pos = 0;\n\n    // look for the Base64 encoded part of the line to decode\n    for (String part : keyLine.split(\" \")) {\n        if (part.startsWith(BASE64_PREFIX)) {\n            this.bytes = org.apache.commons.codec.binary.Base64.decodeBase64(part);\n            break;\n        }\n    }\n\n    if (this.bytes == null || this.bytes.length == 0) {\n        throw new IllegalArgumentException(\"no Base64 part to decode\");\n    }\n\n    try {\n        String type = decodeType();\n\n        if (\"ssh-rsa\".equals(type)) {\n            if (pos >= bytes.length) {\n                throw new IllegalArgumentException(\"truncated RSA key data\");\n            }\n            java.math.BigInteger exponent = decodeBigInt();\n            java.math.BigInteger modulus = decodeBigInt();\n            java.security.spec.RSAPublicKeySpec spec = new java.security.spec.RSAPublicKeySpec(modulus, exponent);\n            return java.security.KeyFactory.getInstance(\"RSA\").generatePublic(spec);\n        } else if (\"ssh-dss\".equals(type)) {\n            if (pos >= bytes.length) {\n                throw new IllegalArgumentException(\"truncated DSA key data\");\n            }\n            java.math.BigInteger p = decodeBigInt();\n            java.math.BigInteger q = decodeBigInt();\n            java.math.BigInteger g = decodeBigInt();\n            java.math.BigInteger y = decodeBigInt();\n            java.security.spec.DSAPublicKeySpec spec = new java.security.spec.DSAPublicKeySpec(y, p, q, g);\n            return java.security.KeyFactory.getInstance(\"DSA\").generatePublic(spec);\n        } else {\n            throw new IllegalArgumentException(\"unknown key type \" + type);\n        }\n    } catch (IndexOutOfBoundsException e) {\n        throw new IllegalArgumentException(\"invalid or truncated key data\", e);\n    }\n}",
  "explanation": "code_hardening: Added null/empty validation for keyLine, explicit initialization of bytes and pos, and basic length checks to avoid reading past the end of the decoded byte array while keeping behavior identical for valid inputs.\nresolve_compilation_errors: Declared and referenced existing class fields bytes and pos, used fully qualified names for security, spec, and math classes where appropriate, and relied on the already-present org.apache.commons.codec.binary.Base64.\nexception_handling: Replaced a generic throws Exception with GeneralSecurityException and IllegalArgumentException, and wrapped low-level IndexOutOfBoundsException with a clearer decoding error message.\nlogic_customization: Introduced a named BASE64_PREFIX constant for the \"AAAA\" check and kept the original RSA/DSA decoding logic unchanged.\nrefactoring: Renamed local variables m/e to modulus/exponent for clarity without altering logic or external behavior.\nmisc: Applied consistent formatting and brief inline comments; no new custom API calls were introduced."
}