{
  "code": "private void updatePredecessorsWithCheckMode(TreePath tp, boolean checkMode) {\n        if (tp == null || nodesCheckingState == null) {\n            return;\n        }\n        TreePath parentPath = tp.getParentPath();\n        while (parentPath != null) {\n            CheckedNode parentCheckedNode = nodesCheckingState.get(parentPath);\n            if (parentCheckedNode == null) {\n                return;\n            }\n            DefaultMutableTreeNode parentNode = (DefaultMutableTreeNode) parentPath.getLastPathComponent();\n            boolean allChildrenSelected = true;\n            boolean anyChildSelected = false;\n            for (int i = 0; i < parentNode.getChildCount(); i++) {\n                TreePath childPath = parentPath.pathByAddingChild(parentNode.getChildAt(i));\n                CheckedNode childCheckedNode = nodesCheckingState.get(childPath);\n                if (childCheckedNode == null) {\n                    allChildrenSelected = false;\n                    continue;\n                }\n                if (!allSelected(childCheckedNode)) {\n                    allChildrenSelected = false;\n                }\n                if (childCheckedNode.isSelected) {\n                    anyChildSelected = true;\n                }\n            }\n            parentCheckedNode.allChildrenSelected = allChildrenSelected;\n            parentCheckedNode.isSelected = anyChildSelected;\n            if (parentCheckedNode.isSelected) {\n                checkedPaths.add(parentPath);\n            } else {\n                checkedPaths.remove(parentPath);\n            }\n            parentPath = parentPath.getParentPath();\n        }\n    }",
  "explanation": "code_hardening: Added null checks for the incoming TreePath and the nodesCheckingState map, guarded against missing CheckedNode entries, and ensured upward traversal stops safely when the root is reached.\nresolve_compilation_errors: Introduced the missing updatePredecessorsWithCheckMode method with a signature consistent with its call site; relied only on existing fields (nodesCheckingState, checkedPaths) and the existing allSelected method.\nexception_handling: none.\nlogic_customization: Replaced renderer-oriented logic with model state propagation: for each ancestor, recomputed allChildrenSelected based on full subtree selection, recomputed isSelected based on whether any direct child is selected, updated checkedPaths accordingly, and iterated upward until no parent path exists.\nrefactoring: Centralized ancestor recomputation into a single reusable method with clear local variable names reflecting model state rather than UI concerns.\nmisc: Added minimal inline structure to reflect tri-state propagation behavior; no new custom API calls were introduced."
}