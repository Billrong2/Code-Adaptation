{
  "code": "public static boolean onTouchEvent(View v, MotionEvent event) {\n    if (!(v instanceof TextView) || event == null) return false;\n\n    TextView widget = (TextView) v;\n    CharSequence text = widget.getText();\n    if (!(text instanceof Spanned)) return false;\n\n    Spanned spanned = (Spanned) text;\n    int action = event.getAction();\n    if (action != MotionEvent.ACTION_DOWN && action != MotionEvent.ACTION_UP) return false;\n\n    Layout layout = widget.getLayout();\n    if (layout == null) return false;\n\n    int x = (int) event.getX();\n    int y = (int) event.getY();\n\n    x -= widget.getTotalPaddingLeft();\n    y -= widget.getTotalPaddingTop();\n    x += widget.getScrollX();\n    y += widget.getScrollY();\n\n    int line = layout.getLineForVertical(y);\n    int off = layout.getOffsetForHorizontal(line, x);\n\n    ClickableSpan[] links = spanned.getSpans(off, off, ClickableSpan.class);\n    if (links == null || links.length == 0) return false;\n\n    if (action == MotionEvent.ACTION_UP) {\n        links[0].onClick(widget);\n        return true;\n    }\n\n    // ACTION_DOWN: only highlight selection if text is actually Spannable\n    if (action == MotionEvent.ACTION_DOWN && text instanceof Spannable) {\n        Spannable spannable = (Spannable) text;\n        Selection.setSelection(spannable,\n                spannable.getSpanStart(links[0]),\n                spannable.getSpanEnd(links[0]));\n        return true;\n    }\n\n    return false;\n}",
  "explanation": "code_hardening: Added null checks for View, MotionEvent, Layout, and text; verified View is a TextView; guarded selection logic so it runs only when the text is both Spanned and Spannable; safely ignored unsupported motion actions.\nresolve_compilation_errors: Removed reliance on instance context by accepting View as a parameter; replaced unsafe casts with instanceof checks; ensured signature matches callers from setOnTouchListener/onTouch.\nexception_handling: No try/catch added per plan; defensive checks eliminate potential ClassCastException and NullPointerException sources.\nlogic_customization: Converted the original onTouchEvent override into a static utility; treated text generically as Spanned for link detection; preserved link clicking on ACTION_UP; limited selection highlighting on ACTION_DOWN to Spannable texts only.\nrefactoring: Clarified local variable names (v -> widget, text -> spanned); restructured control flow for early exits; removed override-specific assumptions.\nmisc: Updated behavior to align with utility-based usage without movement method; no new custom API calls introduced."
}