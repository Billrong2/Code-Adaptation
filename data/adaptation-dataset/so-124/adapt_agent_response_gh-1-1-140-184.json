{
  "code": "/**\n\t * Returns a set of external storage mount points by parsing the output of the\n\t * platform \"mount\" command. This relies on the command's textual output format\n\t * and may not work uniformly across all Android versions or devices.\n\t */\n\tpublic static Set<String> getExternalMounts()\n\t{\n\t\tfinal Set<String> mounts = new HashSet<>();\n\n\t\t// Regex and command preserved exactly from original logic\n\t\tfinal String MOUNT_COMMAND = \"mount\";\n\t\tfinal String MOUNT_LINE_REGEX = \"(?i).*vold.*(vfat|ntfs|exfat|fat32|ext3|ext4).*rw.*\";\n\n\t\tfinal StringBuilder outputBuilder = new StringBuilder();\n\n\t\ttry\n\t\t{\n\t\t\tfinal Process process = new ProcessBuilder().command(MOUNT_COMMAND)\n\t\t\t\t\t.redirectErrorStream(true)\n\t\t\t\t\t.start();\n\n\t\t\t// Wait for process to complete\n\t\t\tprocess.waitFor();\n\n\t\t\t// Read process output safely\n\t\t\ttry (InputStream inputStream = process.getInputStream())\n\t\t\t{\n\t\t\t\tfinal byte[] buffer = new byte[1024];\n\t\t\t\tint bytesRead;\n\t\t\t\twhile ((bytesRead = inputStream.read(buffer)) != -1)\n\t\t\t\t{\n\t\t\t\t\toutputBuilder.append(new String(buffer, 0, bytesRead));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcatch (IOException e)\n\t\t{\n\t\t\t// I/O failure while executing or reading from mount command\n\t\t\te.printStackTrace();\n\t\t}\n\t\tcatch (InterruptedException e)\n\t\t{\n\t\t\t// Restore interrupted status and continue with whatever output was collected\n\t\t\tThread.currentThread().interrupt();\n\t\t\te.printStackTrace();\n\t\t}\n\n\t\tfinal String output = outputBuilder.toString();\n\t\tif (output.isEmpty())\n\t\t{\n\t\t\treturn mounts;\n\t\t}\n\n\t\t// Parse mount output\n\t\tfinal String[] lines = output.split(\"\\n\");\n\t\tfor (final String line : lines)\n\t\t{\n\t\t\tif (!line.toLowerCase(Locale.US).contains(\"asec\"))\n\t\t\t{\n\t\t\t\tif (line.matches(MOUNT_LINE_REGEX))\n\t\t\t\t{\n\t\t\t\t\tfinal String[] parts = line.split(\" \");\n\t\t\t\t\tfor (final String part : parts)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (part.startsWith(\"/\"))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (!part.toLowerCase(Locale.US).contains(\"vold\"))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tmounts.add(part);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn mounts;\n\t}",
  "explanation": "code_hardening: Used try-with-resources for the InputStream, switched to StringBuilder instead of string concatenation in a loop, read only the valid byte count from InputStream.read, added empty-output guarding, and restored the thread interrupt status when InterruptedException occurs.\nresolve_compilation_errors: Generalized the return type to Set<String> while retaining HashSet internally, relied on existing project imports (Set, HashSet, Locale, InputStream) and java.lang.ProcessBuilder, and aligned the signature with callers expecting a Set.\nexception_handling: Replaced the broad Exception catch with specific IOException and InterruptedException handling, printing stack traces consistently with surrounding code and restoring interrupt status for InterruptedException.\nlogic_customization: Preserved the original mount parsing behavior exactly, including the same regex, filters, command invocation, and path extraction logic; no new APIs or conditional behavior were introduced.\nrefactoring: Renamed ambiguous variables to descriptive names, extracted magic strings into well-named local constants, added clarifying comments, applied the diamond operator, and marked locals as final where appropriate.\nmisc: Added method-level Javadoc documenting purpose and limitations and reformatted the method to match standard Java style; no new custom API calls were introduced."
}