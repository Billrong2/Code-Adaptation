{
  "code": "public static <K,V extends Comparable<? super V>> java.util.SortedSet<java.util.Map.Entry<K,V>> entriesSortedByValues(java.util.Map<K,V> map, final boolean ascending)\n{\n\tif (map == null) throw new NullPointerException(\"map\");\n\t\n\tjava.util.SortedSet<java.util.Map.Entry<K,V>> sortedEntries = new java.util.TreeSet<java.util.Map.Entry<K,V>>(\n\t\tnew java.util.Comparator<java.util.Map.Entry<K,V>>()\n\t\t{\n\t\t\t@Override\n\t\t\tpublic int compare(java.util.Map.Entry<K,V> entry1, java.util.Map.Entry<K,V> entry2)\n\t\t\t{\n\t\t\t\tint res = entry1.getValue().compareTo(entry2.getValue());\n\t\t\t\tif ( ! ascending) res = -res;\n\t\t\t\t// Always return non-zero for equal values to retain all entries in the TreeSet\n\t\t\t\treturn res != 0 ? res : 1;\n\t\t\t}\n\t\t}\n\t);\n\t\n\tsortedEntries.addAll(map.entrySet());\n\treturn sortedEntries;\n}",
  "explanation": "code_hardening: Added a null check for the input map and throw a NullPointerException to fail fast, matching common patterns in this utility class. Kept the comparator simple and deterministic, with a comment clarifying TreeSet behavior when comparisons return zero.\nresolve_compilation_errors: Updated the method signature to include the boolean parameter and ensured generic bounds and fully qualified types are correct within the single function context. No external imports or APIs were required.\nexception_handling: none\nlogic_customization: Introduced the boolean parameter (ascending) to control sort order by reversing the comparison result when false. Removed the key-equality special case; when values compare equal the comparator always returns a non-zero value so all entries are retained in the TreeSet.\nrefactoring: Changed visibility to public and renamed comparator parameters to entry1/entry2 for clarity. Simplified comparator logic after removing the key-based branch.\nmisc: none"
}