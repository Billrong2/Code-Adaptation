{
  "code": "@Override\npublic boolean onTouchEvent(@NonNull TextView textView, @NonNull Spannable spannable, @NonNull MotionEvent event) {\n    final int action = event.getAction();\n\n    if (action == MotionEvent.ACTION_DOWN) {\n        mPressedSpan = getPressedSpan(textView, spannable, event);\n        if (mPressedSpan != null) {\n            mPressedSpan.setPressed(true);\n            Selection.setSelection(\n                    spannable,\n                    spannable.getSpanStart(mPressedSpan),\n                    spannable.getSpanEnd(mPressedSpan)\n            );\n        }\n    } else if (action == MotionEvent.ACTION_MOVE) {\n        final NoteBlockClickableSpan touchedSpan = getPressedSpan(textView, spannable, event);\n        if (mPressedSpan != null && touchedSpan != mPressedSpan) {\n            mPressedSpan.setPressed(false);\n            mPressedSpan = null;\n            Selection.removeSelection(spannable);\n        }\n    } else {\n        if (mPressedSpan != null) {\n            mPressedSpan.setPressed(false);\n            super.onTouchEvent(textView, spannable, event);\n        }\n        mPressedSpan = null;\n        Selection.removeSelection(spannable);\n    }\n\n    return true;\n}",
  "explanation": "code_hardening: Added @NonNull annotations to TextView, Spannable, and MotionEvent parameters; used final for local variables where appropriate; retained defensive null-checks around mPressedSpan and touched span results.\nresolve_compilation_errors: Replaced the generic TouchableSpan with the concrete NoteBlockClickableSpan during ACTION_MOVE; ensured all span references and comparisons use NoteBlockClickableSpan, matching the existing field and getPressedSpan return type.\nexception_handling: none.\nlogic_customization: Updated span comparison logic in ACTION_MOVE to use NoteBlockClickableSpan while preserving all pressed/unpressed behavior, selection handling, event branching, super call, and return value.\nrefactoring: Introduced a local action variable to avoid repeated event.getAction() calls; aligned variable naming (touchedSpan) with the concrete span type for clarity.\nmisc: Added minimal formatting and comments implicitly via clear structure; no new custom API calls were introduced beyond existing project methods (getPressedSpan, super.onTouchEvent)."}