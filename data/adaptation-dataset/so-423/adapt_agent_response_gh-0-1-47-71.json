{
  "code": "public static void handleStoragePermissionResult(final int requestCode, final String[] permissions, final int[] grantResults, final Context parentActivity) {\n    // Utility-style callback; must be invoked manually by the caller\n    if (parentActivity == null) {\n        return;\n    }\n\n    if (permissions == null || grantResults == null || grantResults.length == 0) {\n        return;\n    }\n\n    final String deniedMessage = \"The app was not allowed to write to your storage. Hence, it cannot function properly. Please consider granting it this permission\";\n\n    switch (requestCode) {\n        case REQUEST_WRITE_STORAGE: {\n            if (grantResults[0] == android.content.pm.PackageManager.PERMISSION_GRANTED) {\n                // Permission granted: caller may proceed with storage-dependent features\n                hasPermission = true;\n            } else {\n                android.widget.Toast.makeText(parentActivity, deniedMessage, android.widget.Toast.LENGTH_LONG).show();\n                hasPermission = false;\n            }\n            break;\n        }\n        default:\n            // no-op for other request codes\n            break;\n    }\n}",
  "explanation": "code_hardening: Added null checks for parentActivity, permissions, and grantResults, and guarded against empty grantResults before indexing; marked parameters as final to avoid reassignment.\nresolve_compilation_errors: Removed @Override and any super.onRequestPermissionsResult call; introduced an explicit Context parentActivity parameter; relied on the existing REQUEST_WRITE_STORAGE constant in the same class; used fully qualified names where imports are not guaranteed.\nexception_handling: none.\nlogic_customization: Converted the callback into a public static utility method that can be invoked manually; preserved the switch on requestCode and the permission granted/denied behavior, including showing a Toast; updated hasPermission state consistently with the result.\nrefactoring: Renamed the method to reflect a utility-style handler; extracted the Toast message into a local constant for readability.\nmisc: Updated comments to clarify manual invocation and kept formatting consistent with a utility method; no new custom API calls were introduced beyond existing Android framework calls."
}