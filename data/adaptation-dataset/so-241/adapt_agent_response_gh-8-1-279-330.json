{
  "code": "private void ensureList() {\n    if (mList != null) {\n        return;\n    }\n    View root = getView();\n    if (root == null) {\n        throw new IllegalStateException(\"Content view not yet created\");\n    }\n\n    if (root instanceof ExpandableListView) {\n        mList = (ExpandableListView) root;\n    } else {\n        // Discover standard empty TextView using framework id\n        View emptyCandidate = root.findViewById(android.R.id.empty);\n        if (emptyCandidate instanceof TextView) {\n            mStandardEmptyView = (TextView) emptyCandidate;\n        }\n\n        // Initialize list container from concrete layout container\n        mListContainer = root.findViewById(com.money.manager.ex.R.id.container);\n\n        View rawListView = root.findViewById(android.R.id.list);\n        if (!(rawListView instanceof ExpandableListView)) {\n            if (rawListView == null) {\n                throw new RuntimeException(\n                        \"Your content must have a ExpandableListView whose id attribute is \" +\n                                \"'android.R.id.list'\");\n            }\n            throw new RuntimeException(\n                    \"Content has view with id attribute 'android.R.id.list' \" +\n                            \"that is not a ExpandableListView class\");\n        }\n        mList = (ExpandableListView) rawListView;\n\n        // Wrap the standard empty view in a ScrollView if present\n        if (mStandardEmptyView != null) {\n            View parent = (View) mStandardEmptyView.getParent();\n            if (parent instanceof ScrollView) {\n                mEmptyViewScroll = (ScrollView) parent;\n            } else if (parent instanceof ViewGroup) {\n                ViewGroup parentGroup = (ViewGroup) parent;\n                int index = parentGroup.indexOfChild(mStandardEmptyView);\n                parentGroup.removeView(mStandardEmptyView);\n                mEmptyViewScroll = new ScrollView(root.getContext());\n                mEmptyViewScroll.setLayoutParams(new ViewGroup.LayoutParams(\n                        ViewGroup.LayoutParams.MATCH_PARENT,\n                        ViewGroup.LayoutParams.MATCH_PARENT));\n                mEmptyViewScroll.addView(mStandardEmptyView,\n                        new ViewGroup.LayoutParams(\n                                ViewGroup.LayoutParams.MATCH_PARENT,\n                                ViewGroup.LayoutParams.WRAP_CONTENT));\n                parentGroup.addView(mEmptyViewScroll, index);\n            }\n\n            // Assign scrollable empty view to the list\n            if (mEmptyViewScroll != null) {\n                mList.setEmptyView(mEmptyViewScroll);\n                mEmptyViewScroll.setVisibility(View.GONE);\n            }\n        }\n    }\n\n    mListShown = true;\n    mList.setOnItemClickListener(mOnClickListener);\n    if (mAdapter != null) {\n        setListAdapter(mAdapter);\n    } else {\n        // No adapter yet: start with the list hidden (loading state)\n        setListShown(false, false);\n    }\n    mHandler.post(mRequestFocus);\n}",
  "explanation": "code_hardening: Added null checks for getView(), empty view discovery, parent containers, and the new ScrollView wrapper before assignment. Ensured visibility initialization on the empty ScrollView to avoid illegal visible states.\nresolve_compilation_errors: Replaced INTERNAL_EMPTY_ID usage with android.R.id.empty, initialized mListContainer via com.money.manager.ex.R.id.container, and declared/used mEmptyViewScroll consistently with existing fields and fully qualified R reference.\nexception_handling: Preserved existing IllegalStateException and RuntimeException behavior for missing or invalid list views; no new unchecked exceptions introduced by guarded view lookups.\nlogic_customization: Implemented scrollable empty-state behavior by wrapping the standard empty TextView in a ScrollView and assigning it via setEmptyView. Ensured empty text set elsewhere will populate the standard TextView while the ScrollView acts as the listâ€™s empty view.\nrefactoring: Removed reliance on the internal empty view ID and reorganized list discovery versus empty-state setup for clearer flow within the function.\nmisc: Updated inline comments to reflect scrollable empty-state handling and loading behavior. No new custom API calls were introduced."
}