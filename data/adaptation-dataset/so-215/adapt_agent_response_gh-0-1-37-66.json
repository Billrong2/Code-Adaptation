{
  "code": "/**\n * Resolve the fully qualified class name from the given classfile bytes.\n * \n * @param classBytes compiled classfile bytes\n * @return fully qualified class name\n * @throws Exception if the classfile cannot be parsed\n */\npublic static String getClassName(byte[] classBytes) throws Exception {\n    if (classBytes == null || classBytes.length == 0) {\n        throw new IllegalArgumentException(\"classBytes must not be null or empty\");\n    }\n\n    try (DataInputStream dis = new DataInputStream(new ByteArrayInputStream(classBytes))) {\n        dis.readLong(); // skip header and class version\n        int cpcnt = (dis.readShort() & 0xffff) - 1;\n        int[] classes = new int[cpcnt];\n        String[] strings = new String[cpcnt];\n        for (int i = 0; i < cpcnt; i++) {\n            int t = dis.read();\n            if (t == 7) {\n                classes[i] = dis.readShort() & 0xffff;\n            } else if (t == 1) {\n                strings[i] = dis.readUTF();\n            } else if (t == 5 || t == 6) {\n                dis.readLong();\n                i++;\n            } else if (t == 8) {\n                dis.readShort();\n            } else {\n                dis.readInt();\n            }\n        }\n        dis.readShort(); // skip access flags\n        return strings[classes[(dis.readShort() & 0xffff) - 1] - 1].replace('/', '.');\n    }\n}",
  "explanation": "code_hardening: Added validation to ensure the provided byte[] is non-null and non-empty, and used try-with-resources to guarantee the DataInputStream (and underlying ByteArrayInputStream) is closed.\nresolve_compilation_errors: Updated the method signature to accept byte[] instead of InputStream and created a ByteArrayInputStream internally; relied on existing project imports so no additional compilation issues arise.\nexception_handling: Preserved the existing `throws Exception` contract and ensured resource management does not introduce unchecked exceptions.\nlogic_customization: Replaced direct InputStream usage with a ByteArrayInputStream wrapped by DataInputStream while keeping the classfile parsing logic and slash-to-dot class name resolution unchanged.\nrefactoring: Renamed the parameter to `classBytes` for clarity and added a brief Javadoc describing the new byte[]-based API.\nmisc: Minor formatting and comments aligned with the new API; no new custom API calls were introduced."
}