{
  "code": "@Override\nprotected boolean setFrame(int l, int t, int r, int b) {\n    // Derive view dimensions from frame bounds\n    final int viewWidth = r - l;\n    final int viewHeight = b - t;\n\n    // Guard against null drawable and invalid dimensions\n    if (getDrawable() != null && viewWidth > 0 && viewHeight > 0) {\n        final int intrinsicWidth = getDrawable().getIntrinsicWidth();\n        final int intrinsicHeight = getDrawable().getIntrinsicHeight();\n\n        if (intrinsicWidth > 0 && intrinsicHeight > 0) {\n            final Matrix matrix = getImageMatrix();\n\n            final float scaleFactorWidth = (float) viewWidth / (float) intrinsicWidth;\n            final float scaleFactorHeight = (float) viewHeight / (float) intrinsicHeight;\n            final float scaleFactor = Math.max(scaleFactorWidth, scaleFactorHeight);\n\n            // Scale from top-left corner\n            matrix.setScale(scaleFactor, scaleFactor, 0f, 0f);\n            setImageMatrix(matrix);\n        }\n    }\n\n    return super.setFrame(l, t, r, b);\n}",
  "explanation": "code_hardening: Added guard clauses to ensure getDrawable() is non-null and that both view and intrinsic dimensions are greater than zero before performing any matrix or scaling operations, preventing NPEs and invalid math.\nresolve_compilation_errors: Removed reliance on undefined width/height variables and derived the view dimensions directly from the setFrame parameters (r - l, b - t).\nexception_handling: none.\nlogic_customization: Updated the scaling logic to use frame-derived dimensions while preserving the original scale-to-fill behavior by selecting the larger of the width/height scale factors and applying it with a top-left pivot to the image matrix before calling super.setFrame.\nrefactoring: Renamed local variables for clarity (viewWidth, viewHeight, scaleFactorWidth, scaleFactorHeight) and simplified scale factor selection using Math.max without changing behavior.\nmisc: none."
}