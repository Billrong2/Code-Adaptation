{
  "code": "private void ensureList() {\n\tif (mList != null) {\n\t\treturn;\n\t}\n\tfinal View root = getView();\n\tif (root == null) {\n\t\tthrow new IllegalStateException(\"Content view not yet created; cannot ensure list\");\n\t}\n\n\t// Identify list container\n\tmListContainer = root;\n\n\t// Locate ExpandableListView either as root or via android.R.id.list\n\tView listView;\n\tif (root instanceof ExpandableListView) {\n\t\tlistView = root;\n\t} else {\n\t\tlistView = root.findViewById(android.R.id.list);\n\t}\n\tif (listView == null) {\n\t\tthrow new IllegalStateException(\"Your content must have an ExpandableListView whose id attribute is 'android.R.id.list'\");\n\t}\n\tif (!(listView instanceof ExpandableListView)) {\n\t\tthrow new IllegalStateException(\"View with id 'android.R.id.list' is not an ExpandableListView\");\n\t}\n\tmList = (ExpandableListView) listView;\n\n\t// Empty view handling\n\tView emptyView = root.findViewById(android.R.id.empty);\n\tif (emptyView == null) {\n\t\tView standardEmpty = root.findViewById(INTERNAL_EMPTY_ID);\n\t\tif (standardEmpty instanceof TextView) {\n\t\t\tmStandardEmptyView = (TextView) standardEmpty;\n\t\t\temptyView = mStandardEmptyView;\n\t\t}\n\t}\n\tif (emptyView != null) {\n\t\tmList.setEmptyView(emptyView);\n\t}\n\n\t// Attach listeners\n\tmList.setOnChildClickListener(this);\n\tmList.setOnGroupExpandListener(this);\n\tmList.setOnGroupCollapseListener(this);\n\tmList.setOnItemLongClickListener(mOnLongClickListener);\n\n\t// Initial state: list is considered shown once initialized\n\tmListShown = true;\n\n\t// Adapter or progress handling\n\tif (mAdapter != null) {\n\t\tmList.setAdapter((ExpandableListAdapter) null);\n\t\tmList.setAdapter(mAdapter);\n\t} else {\n\t\t// No adapter yet; start in progress state without animation\n\t\tsetListShown(false, false);\n\t}\n\n\t// Request focus after setup\n\tmHandler.post(mRequestFocus);\n}",
  "explanation": "code_hardening: Added null checks for the fragment root view, validated presence of the list container, and ensured the discovered view is an ExpandableListView before casting. Guarded against repeated initialization by returning early when mList is already set.\nresolve_compilation_errors: Avoided any references to removed fields (mProgressContainer, mExpandableListContainer, mExpandableListShown) and aligned state tracking with existing fields mListContainer and mListShown. Used only types and fields present in the codebase.\nexception_handling: Replaced generic failures with clear IllegalStateException messages when the root view is missing, the list view cannot be found, or the view with android.R.id.list is of the wrong type, ensuring fast failure during view lifecycle initialization.\nlogic_customization: Replaced the old visibility/animation toggle logic with a one-time initialization routine. Located the ExpandableListView from the root or via android.R.id.list, wired empty view handling using android.R.id.empty or the standard empty TextView, attached child/group and long-click listeners, set initial list state, applied the adapter if present or invoked setListShown(false, false) to indicate progress, and posted a focus request via Handler.\nrefactoring: Consolidated all setup-centric behavior into ensureList, removing animation concerns and relying on mListShown for state. Simplified control flow to reflect initialization rather than repeated visibility toggling.\nmisc: Updated in-function comments to reflect setup-oriented behavior and maintained formatting consistent with the surrounding class. New custom API calls used beyond the SO snippet: none."
}