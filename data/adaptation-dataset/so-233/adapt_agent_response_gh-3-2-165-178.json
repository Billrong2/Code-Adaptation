{
  "code": "private static Map<String, Object> toMap(JSONObject object) throws JSONException {\n        if (object == null)\n            return new HashMap<>(0);\n\n        final int size = object.length();\n        final Map<String, Object> map = new HashMap<>(size);\n        final Set<String> keys = object.keySet();\n\n        for (String key : keys) {\n            Object value = object.get(key);\n            if (value instanceof JSONArray) {\n                value = toList((JSONArray) value);\n            } else if (value instanceof JSONObject) {\n                value = toMap((JSONObject) value);\n            }\n            map.put(key, value);\n        }\n        return map;\n    }",
  "explanation": "code_hardening: added a null-check for the input JSONObject to avoid NullPointerException and return an empty pre-sized map; marked local references as final where appropriate and ensured empty JSONObjects/JSONArrays are handled naturally by iteration.\nresolve_compilation_errors: aligned the method with the existing private static toList(JSONArray) method, relied on JSONObject.keySet() which returns Set<String>, and kept types consistent with existing imports; no external dependencies introduced.\nexception_handling: preserved the throws JSONException declaration and allowed recursive calls to propagate JSONException consistently without internal catching.\nlogic_customization: replaced iterator-based key traversal with an enhanced for-loop over object.keySet(), pre-sized the HashMap using object.length(), and preserved the recursive conversion of JSONArray to List and JSONObject to Map.\nrefactoring: changed visibility from public static to private static, renamed locals for clarity (keys instead of iterator), and simplified control flow while keeping behavior identical.\nmisc: applied minor formatting consistent with surrounding code; no new custom API calls were introduced."
}